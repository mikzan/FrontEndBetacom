<h2 class="mt-2 text-center">Gestione clienti</h2>
<h4 class="mx-2">Filtri per ricerca</h4>
<p class="mx-3">
  Puoi ricercare i clienti, a seconda delle informazioni necessarie
</p>

<!-- I pulsanti di ricerca -->
<button mat-flat-button color="primary" (click)="cercaNome()" class="ms-3 mb-3">
  Cerca per nome
</button>
<button
  mat-flat-button
  color="primary"
  (click)="cercaCognome()"
  class="ms-3 mb-3"
>
  Cerca per cognome
</button>
<button
  mat-flat-button
  color="primary"
  (click)="cercaComune()"
  class="ms-3 mb-3"
>
  Cerca per comune
</button>
<button
  mat-flat-button
  color="primary"
  (click)="cercaProvincia()"
  class="ms-3 mb-3"
>
  Cerca per provincia
</button>
<button mat-flat-button color="primary" (click)="cercaCap()" class="ms-3 mb-3">
  Cerca per CAP
</button>

<!-- Filtra per Ruolo -->
<div id="filtro-ruoli-utente" class="row">
  <div class="col-sm-12">
    <button mat-flat-button [matMenuTriggerFor]="menu">
      Filtra per Ruolo:
      <span>{{ ruoloSelezionato || "Seleziona" }}</span>
    </button>
    <mat-menu #menu="matMenu">
      <button mat-menu-item (click)="setRuolo('UTENTE')">Utente</button>
      <button mat-menu-item (click)="setRuolo('ADMIN')">Admin</button>
    </mat-menu>
  </div>
</div>

<!-- Reset -->
<button (click)="reset()" class="ms-3 mb-3 btn btn-danger text-center">
  <mat-icon class="d-inline-block align-middle">cancel</mat-icon> Reset
</button>

<!-- Tabella dei clienti -->
<table class="table table-striped table-hover">
  <thead>
    <tr align="center">
      <th scope="col">Id</th>
      <th scope="col">Nome</th>
      <th scope="col">Cognome</th>
      <th scope="col">Ruolo</th>
      <th scope="col">Email</th>
      <th scope="col">Telefono</th>
      <th scope="col">Username</th>
      <th scope="col">Via</th>
      <th scope="col">Comune</th>
      <th scope="col">Provincia</th>
      <th scope="col">CAP</th>
      <th scope="col">Data di Registrazione</th>
      <th scope="col">Azioni</th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let cliente of clienti" align="center">
      <th scope="row">{{ cliente.idCliente }}</th>
      <td *ngIf="editModeClienteId !== cliente.idCliente">
        {{ cliente.nome }}
      </td>
      <td *ngIf="editModeClienteId === cliente.idCliente">
        <input [(ngModel)]="cliente.nome" class="form-control" />
      </td>
      <td *ngIf="editModeClienteId !== cliente.idCliente">
        {{ cliente.cognome }}
      </td>
      <td *ngIf="editModeClienteId === cliente.idCliente">
        <input [(ngModel)]="cliente.cognome" class="form-control" />
      </td>
      <td>{{ cliente.utente?.roles }}</td>
      <td>{{ cliente.utente?.email }}</td>
      <td *ngIf="editModeClienteId !== cliente.idCliente">
        {{ cliente.telefono }}
      </td>
      <td *ngIf="editModeClienteId === cliente.idCliente">
        <input [(ngModel)]="cliente.telefono" class="form-control" />
      </td>
      <td>{{ cliente.utente?.username }}</td>
      <td *ngIf="editModeClienteId !== cliente.idCliente">{{ cliente.via }}</td>
      <td *ngIf="editModeClienteId === cliente.idCliente">
        <input [(ngModel)]="cliente.via" class="form-control" />
      </td>
      <td *ngIf="editModeClienteId !== cliente.idCliente">
        {{ cliente.comune }}
      </td>
      <td *ngIf="editModeClienteId === cliente.idCliente">
        <input [(ngModel)]="cliente.comune" class="form-control" />
      </td>
      <td *ngIf="editModeClienteId !== cliente.idCliente">
        {{ cliente.provincia }}
      </td>
      <td *ngIf="editModeClienteId === cliente.idCliente">
        <input [(ngModel)]="cliente.provincia" class="form-control" />
      </td>
      <td *ngIf="editModeClienteId !== cliente.idCliente">{{ cliente.cap }}</td>
      <td *ngIf="editModeClienteId === cliente.idCliente">
        <input [(ngModel)]="cliente.cap" class="form-control" />
      </td>
      <td>{{ cliente.dataRegistrazione | date : "longDate" }}</td>

      <td>
        <button
          *ngIf="editModeClienteId !== cliente.idCliente"
          (click)="modificaCliente(cliente.idCliente)"
          class="btn btn-warning"
        >
          Modifica
        </button>
        <button
          *ngIf="editModeClienteId === cliente.idCliente"
          (click)="salvaModificheCliente(cliente)"
          class="btn btn-success"
        >
          Salva
        </button>
        <button
          *ngIf="editModeClienteId === cliente.idCliente"
          (click)="annullaModificheCliente()"
          class="btn btn-warning"
        >
          Annulla
        </button>
      </td>
    </tr>
  </tbody>
</table>

<!-- Paginazione -->
